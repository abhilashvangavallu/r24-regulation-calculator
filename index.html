<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      height:96vh;
      width:96vw;
      background: #25ad21;
    }

    .page {
      position: absolute;
      align-content: center;
      top: 0;
      left: 100%;
      width: 96vw;
      height: 96vh;
      background: #00ffff17;
      transition: all 0.6s ease;
      padding: 20px;
      opacity: 0;
      pointer-events: none;
    }

    .page.active {
      left: 0;
      opacity: 1;
      pointer-events: auto;
      z-index: 2;
    }

    .page.exit-left {
      left: -100%;
      opacity: 0;
    }

    .home button {
      padding: 15px 25px;
      border: none;
      width: 150px;
      background: #3d588345;
      border-radius: 5px;
      background: #79f30d6e;
      color: rgb(11, 15, 10);
      font-weight: bold;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .home button:hover {
      background: #e7e7e7;
    }

    body {
      background-size: cover;
      background-color: lightblue;
    }

    #home {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 20px;
      background: #f2f3f5;
      text-align: center;
      width: 150px;
      height: 200px;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    #sgpa {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 20px;
      background: #f2f3f5;
      text-align: center;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      background-color: #00ffc1;
    }

    .container {
      padding-top: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      background-color:lightblue;
      height: 96vh;
      width: 96vw;
      background-size: cover;
    }

    * {
      font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    .selector {
      display: flex;
      flex-direction: column;
      background-color: rgb(179, 233, 174);
      padding: 20px;
      margin: 15px;
      border-radius: 18px;
      border-style: ridge;
    }

    .internals {
      display: flex;
      flex-direction: column;
      width: 350px;
      margin: 10px;
      padding-right: 100px;
    }

    .row {
      display: flex;
      padding-left: 12px;
    }

    .attendance {
      display: flex;
      flex-direction: column;
      background-color: rgb(179, 233, 174);
      width: 350px;
      margin: 10px;
      padding: 10px;
      padding-left: 50px;
      padding-right: 80px;
      border-radius: 18px;
      border-style: ridge;
    }

    .sub {
      display: flex;
      flex-direction: column;
      background-color: lightblue;
      justify-content: center;
      align-items: center;
    }

    .but {
      display: flex;
      flex-direction: column;
      padding-left: 60px;
    }

    .input-style {
      height: 4vh;
    }

    .cal-btn,
    .submit {
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: rgb(233, 240, 233);
      font-size: 16px;
      font-weight: bold;
      height: 48px;
      width: 128px;
      border-radius: 14px;
      border-style: ridge;
      cursor: pointer;
    }

    .cal-btn,
    .submit:hover {
      background-color: rgb(11, 15, 10);
      color: rgba(17, 15, 15, 0.884);
      padding-left: 1%;
    }

    .back-btn {
      position: fixed;
      top: 15px;
      left: 15px;
      background-color: #007bff;
      padding: 1%;
      border: none;
      font-weight: 700;
      border-radius: 15px;
      z-index: 10;
      color: white;
      cursor: pointer;
    }
    .back-btn:hover{
      background-color: black;
      color:white;
    }

    .cont {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      border-radius: 30px;
      gap: 30px;
      height: auto;
      max-width: 500px;
      background-color: #f8f9fa;
      padding: 20px;
      margin: 20px auto;
    }
    .con,.ccal{
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      border-radius: 30px;
      gap: 30px;
      height: auto;
      max-width: 300px;
      background-color: #f8f9fa;
      padding: 20px;
      margin: 20px auto;
    }

    .item {
      width: 250px;
      background-color: #75d98e;
    }

    .subject-row {
      display: flex;
      flex-direction: column;
      border: 1px solid rgb(221, 10, 10);
      background-color: rgb(141 204 227);
      height: auto;
      margin-bottom: 20px;
      border-radius: 20px;
      padding: 10px;
      box-sizing: border-box;
    }

    .grade {
      width: 100%;
      max-width: 400px;
      box-sizing: border-box;
      border: 1px solid rgb(82, 79, 79);
      background-color: rgb(217, 225, 228);
      height: 40px;
      text-align: left;
    }

    .cal-btn,#csubmit,#ssubmit {
      height: 30px;
      width: 100px;
      border-radius: 10px;
      cursor: pointer;
      background-color: rgb(252, 248, 250);
    }

    form {
      width: 100%;
      max-width: 500px;
      padding: 10px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    #csubmit:hover {
      background-color: rgba(17, 15, 15, 0.884);
      color:greenyellow;
    }
    #ssubmit:hover {
      background-color: rgba(17, 15, 15, 0.884);
      color:greenyellow;
    }
    .cal-btn:hover {
      background-color: rgba(17, 15, 15, 0.884);
      color:greenyellow;
    }
    #sgpa-year,#sgpa-sem,#sgpa-branch{
      width:250px;
      text-align: center;
    }
    #cgpa-branch,#cgpa-sem{
      width:250px;
      text-align: center;
    }
    #ccal{
      display:flex;
      gap:20px;
      flex-direction: column;
      justify-content:center;
      align-items: center;

    }
  </style>
</head>
<header>
  
<body>
  
  <div class="home page active" id="home">
    <div><button onclick="navigateTo('container')">Internal marks</button></div>
    <div><button onclick="navigateTo('sgpa')">S-GPA</button></div>
    <div><button onclick="navigateTo('cgpa')">C-GPA</button></div>
  </div>
  <div style="padding-top:95vh;text-align: center;"><a style="color:black; " href="https://www.instagram.com/abhilash_vangavallu"><h4><it>Abhilash</it></h4></a> </div>

  <div class="container page" id="container">
    <button class="back-btn" onclick="navigateTo('home')">← Back</button>
    <h1>Internal Marks Calculator</h1>
    <div class="internals">
      <div class="row">
        <div class="selector"><h4>Sessional-1</h4><input type="number" id="s1" /></div>
        <div class="selector"><h4>Sessional-2</h4><input type="number" id="s2" /></div>
      </div>
      <div class="row">
        <div class="selector"><h4>Assignment-1</h4><input type="number" id="a1" /></div>
        <div class="selector"><h4>Assignment-2</h4><input type="number" id="a2" /></div>
      </div>
      <div class="row">
        <div class="selector"><h4>Quiz-1</h4><input type="number" id="q1" /></div>
        <div class="selector"><h4>Quiz-2</h4><input type="number" id="q2" /></div>
      </div>
    </div>
    <div class="but">
      <div class="attendance">
        <h4>Attendance in (%)</h4>
        <input type="number" id="atten" />
      </div>
      <div class="sub">
        <button class="cal-btn" onclick="calculateMarks()">Calculate</button>
      </div>
      <div id="total" style="text-align:center;font-weight:bold;margin-top:20px;"></div>
    </div>
  </div>

  <div class="sgpa page" id="sgpa">
    <div class="cont">
      <button class="back-btn" onclick="navigateTo('home')">← Back</button>
      <div class="item" id="syear">
        <h4>Select Year</h4>
        <select id="sgpa-year">
          <option value="1">1st Year</option>
          <option value="2">2nd Year</option>
          <option value="3">3rd Year</option>
          <option value="4">4th Year</option>
        </select>
      </div>
      <div class="item" id="ssem">
        <h4>Select Semester</h4>
        <select id="sgpa-sem">
          <option value="1">1st Sem</option>
          <option value="2">2nd Sem</option>
        </select>
      </div>
      <div class="item" id="sbranch">
        <h4>Select Branch</h4>
        <select id="sgpa-branch">
          <option value="CSE">CSE</option>
          <option value="CSM">CSM</option>
          <option value="CSD">CSD</option>
          <option value="CSBS">CSBS</option>
          <option value="IT">IT</option>
         <option value="IOT">IOT</option>
         <option value="ECE">ECE</option>
         <option value="EEE">EEE</option>
          <option value="CIVIL">CIVIL</option>
         <option value="MECH">MECH</option>
         <option value="CHEMICAL">CHEM</option>
        </select>
      </div>
      <div><button onclick="navigateTo('scal')" id="ssubmit">Submit</button></div>
    </div>
  </div>

  <div class="cgpa page" id="cgpa">
    <div class="con">
      <button class="back-btn" onclick="navigateTo('home')">← Back</button>
      <div class="item" id="ssem">
        <h4 style="text-align: center; background-color: rgb(242 249 106 / 58%);">Select Semester</h4>
        <select id="cgpa-sem">
           <option value="1">1st Sem</option>
           <option value="2">2nd Sem</option>
           <option value="3">3rd Sem</option>
           <option value="4">4th Sem</option>
           <option value="5">5th Sem</option>
           <option value="6">6th Sem</option>
           <option value="7">7th Sem</option>
           <option value="8">8th Sem</option>
        </select>
      </div>
      <div class="item" id="sbranch">
        <h4 style="text-align: center;background-color: rgb(242 249 106 / 58%) ; ">Select Branch</h4>
        <select id="cgpa-branch">
          <option value="CSE">CSE</option>
          <option value="CSM">CSM</option>
          <option value="CSD">CSD</option>
          <option value="CSBS">CSBS</option>
          <option value="IT">IT</option>
         <option value="IOT">IOT</option>
         <option value="ECE">ECE</option>
         <option value="EEE">EEE</option>
          <option value="CIVIL">CIVIL</option>
         <option value="MECH">MECH</option>
         <option value="CHEMICAL">CHEM</option>
        </select>
      </div>
      <div><button onclick="navigateTo('ccal')" id="csubmit">Submit</button></div>
    </div>
  </div>

  <div class="sgpa-calc page" id="scal"></div>
  <div class="cgpa-calc page" id="ccal">
    <button class="back-btn" onclick="navigateTo('cgpa')">← Back</button>
    <div class="prevsem" id="prev">
      <h4 style="text-align: center;">Enter Previous Semester CGPA</h4>
      <input type="number" id="p" />
    </div>
    <div class="cursem" id="cur">
      <h4 style="text-align: center;">Enter Current Semester SGPA</h4>
      <input type="number" id="c" />
    </div>
    <div class="sub">
      <button class="cal-btn" onclick="calculatecgpa()">Calculate</button>
    </div>
  </div>

  <script>
    let currentPage = 'home';

    function navigateTo(targetId) {
      const current = document.getElementById(currentPage);
      const target = document.getElementById(targetId);

      if (current === target) return;

      current.classList.remove('active');
      current.classList.add('exit-left');

      setTimeout(() => {
        current.classList.remove('exit-left');
      }, 600);

      setTimeout(() => {
        target.classList.add('active');
      }, 100);

      currentPage = targetId;
    }

    function calculateMarks() {
      let se1 = parseFloat(document.getElementById("s1").value) || 0;
      let se2 = parseFloat(document.getElementById("s2").value) || 0;
      let as1 = parseFloat(document.getElementById("a1").value) || 0;
      let as2 = parseFloat(document.getElementById("a2").value) || 0;
      let q1 = parseFloat(document.getElementById("q1").value) || 0;
      let q2 = parseFloat(document.getElementById("q2").value) || 0;
      let a = parseFloat(document.getElementById("atten").value) || 0;

      let total = (se1 > se2 ? se1 * 0.8 + se2 * 0.2 : se2 * 0.8 + se1 * 0.2);
      total += ((as1 + as2 + q1 + q2) / 48) * 7;

      if (a >= 90) total += 5;
      else if (a >= 85) total += 4;
      else if (a >= 80) total += 3;
      else if (a >= 75) total += 2;
      else if (a >= 70) total += 1;

      document.getElementById("total").innerText = `Total Marks: ${total.toFixed(2)}`;
    }
   document.getElementById("ssubmit").addEventListener("click", async () => {
        const year = document.getElementById("sgpa-year").value;
        const sem = document.getElementById("sgpa-sem").value;
        const branch = document.getElementById("sgpa-branch").value;
        const scal=document.getElementById("scal");

        if(!year || !sem || !branch){
            alert("plaese enter correct combinations.");
            return;
        }

        const data=await fetch("creditsr24.json").then(res=>res.json());
        const subjects=data?.[year]?.[sem]?.[branch];

        if(!subjects){
            alert(" SORRY!! NO Subjects Found");
            return;
        }
        window.currentSubjects = subjects;

        if (subjects && subjects.length > 0) {
  scal.innerHTML = `
<div class="cont">
    <button class="back-btn" onclick="navigateTo('sgpa')">← Back</button>
    <h2>Enter Grades</h2>
    <form id="sgpa-form">
    ${subjects.map((sub, index) => `
        <div class="subject-row">
            <label>${sub.subject} (${sub.credits} credits)</label>
            <select id="grade-${index}" selected value="10">  <!-- Added selected and default value for A+ -->
                <option value="10">A+</option>
                <option value="9">A</option>
                <option value="8">B</option>
                <option value="7">C</option>
                <option value="6">D</option>
                <option value="5">E</option>
                <option value="0">F</option>
            </select>
        </div>
    `).join('')}
    <button  type="button" class="cal-btn" onclick="calculateSGPA(window.currentSubjects)">Calculate</button>  <!-- Uncommented and updated -->
    <div id="sgpa-result" style="text-align:center;" ></div>
    </form>
</div>
`;
         navigateTo("scal");
        }
        });

       /* function calculateSGPA(subjects) {
        let totalCredits = 0;
        let totalPoints = 0;

        subjects.forEach((sub, i) => {
            const grade = parseFloat(document.getElementById(`grade-${i}`).value);
            totalCredits += sub.credits;
            totalPoints += grade * sub.credits;
        });

        const sgpa = totalPoints / totalCredits;
        document.getElementById("sgpa-result").innerText = `Your SGPA: ${sgpa.toFixed(2)}`;
        }*/
       function calculateSGPA(subjects) {
    if (typeof subjects === 'string') {
        subjects = JSON.parse(subjects);
    }

    console.log('calculateSGPA called with subjects:', subjects); 

    let totalCredits = 0;
    let totalPoints = 0;

    subjects.forEach((sub, i) => {
        const grade = parseFloat(document.getElementById(`grade-${i}`).value);
        console.log(`Subject ${i}: ${sub.subject}, Credits: ${sub.credits}, Grade Value: ${grade}`); 
        totalCredits += sub.credits;
        totalPoints += grade * sub.credits;
    });

    console.log('Total Credits:', totalCredits, 'Total Points:', totalPoints); 

    const sgpa = totalPoints / totalCredits;
    console.log('Calculated SGPA:', sgpa);

    const resultDiv = document.getElementById("sgpa-result");
    console.log('Result div found:', resultDiv); 
    resultDiv.innerText = `Your SGPA: ${sgpa.toFixed(2)}`;
}
    async function calculatecgpa() {
      const csem = document.getElementById("cgpa-sem").value;
      const cbranch = document.getElementById("cgpa-branch").value;
      const prevCgpa = parseFloat(document.getElementById("p").value);
      const currSgpa = parseFloat(document.getElementById("c").value);
      const resultBox = document.getElementById("ccal");

      if (!csem || !cbranch || isNaN(prevCgpa) || isNaN(currSgpa)) {
        alert("Please fill in all fields correctly!");
        return;
      }

      try {
        const data = await fetch("totalcredits.json").then(res => res.json());
        const branchData = data[csem]?.[cbranch];

        if (!branchData) {
          alert("Invalid semester or branch!");
          return;
        }

        const prevCredits = branchData[0].previous;
        const currCredits = branchData[1].current;
        const newCgpa = ((prevCgpa * prevCredits) + (currSgpa * currCredits)) / (prevCredits + currCredits);
        const finalCgpa = newCgpa.toFixed(2);

        let output = document.getElementById("cgpa-output");
        if (!output) {
          output = document.createElement("div");
          output.id = "cgpa-output";
          output.style.marginTop = "20px";
          output.style.fontWeight = "bold";
          output.style.fontSize = "18px";
          resultBox.appendChild(output);
        }

        output.innerHTML = `
          ${cbranch} - Semester ${csem}<br>
          Updated CGPA: <b>${finalCgpa}</b>
        `;
      } catch (err) {
        console.error(err);
        alert("Error loading credit data!");
      }
    }
  </script>
</body>
</html>


